/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, Inject, PLATFORM_ID, VERSION as AngularVersion, } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';
import * as algoliasearchProxy from 'algoliasearch/lite';
import instantsearch from 'instantsearch.js/es';
import { VERSION } from '../version';
/** @type {?} */
var algoliasearch = algoliasearchProxy.default || algoliasearchProxy;
/**
 * @record
 */
export function SearchRequestParameters() { }
if (false) {
    /** @type {?} */
    SearchRequestParameters.prototype.query;
}
/**
 * @record
 */
export function SearchForFacetValuesRequestParameters() { }
if (false) {
    /** @type {?} */
    SearchForFacetValuesRequestParameters.prototype.facetQuery;
    /** @type {?} */
    SearchForFacetValuesRequestParameters.prototype.facetName;
}
var InstantSearchInstance = /** @class */ (function () {
    function InstantSearchInstance() {
    }
    return InstantSearchInstance;
}());
export { InstantSearchInstance };
if (false) {
    /** @type {?} */
    InstantSearchInstance.prototype.start;
    /** @type {?} */
    InstantSearchInstance.prototype.addWidget;
    /** @type {?} */
    InstantSearchInstance.prototype.addWidgets;
    /** @type {?} */
    InstantSearchInstance.prototype.removeWidget;
    /** @type {?} */
    InstantSearchInstance.prototype.removeWidgets;
    /** @type {?} */
    InstantSearchInstance.prototype.on;
    /** @type {?} */
    InstantSearchInstance.prototype.removeListener;
    /** @type {?} */
    InstantSearchInstance.prototype.helper;
    /** @type {?} */
    InstantSearchInstance.prototype.refresh;
    /** @type {?} */
    InstantSearchInstance.prototype.dispose;
}
var NgAisInstantSearch = /** @class */ (function () {
    function NgAisInstantSearch(platformId) {
        var _this = this;
        this.platformId = platformId;
        this.instanceName = 'default';
        this.change = new EventEmitter();
        this.onRender = function () {
            _this.change.emit({
                results: _this.instantSearchInstance.helper.lastResults,
                state: _this.instantSearchInstance.helper.state,
            });
        };
    }
    /**
     * @return {?}
     */
    NgAisInstantSearch.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.createInstantSearchInstance(this.config);
    };
    /**
     * @return {?}
     */
    NgAisInstantSearch.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        this.instantSearchInstance.start();
    };
    /**
     * @return {?}
     */
    NgAisInstantSearch.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this.instantSearchInstance.removeListener('render', this.onRender);
        this.instantSearchInstance.dispose();
    };
    /**
     * @param {?} config
     * @return {?}
     */
    NgAisInstantSearch.prototype.createInstantSearchInstance = /**
     * @param {?} config
     * @return {?}
     */
    function (config) {
        // add default searchParameters with highlighting config
        if (!config.searchParameters)
            config.searchParameters = {};
        Object.assign(config.searchParameters, {
            highlightPreTag: '__ais-highlight__',
            highlightPostTag: '__/ais-highlight__',
        });
        // remove URLSync widget if on SSR
        if (!isPlatformBrowser(this.platformId)) {
            if (typeof config.urlSync !== 'undefined')
                delete config.urlSync;
            if (typeof config.routing !== 'undefined')
                delete config.routing;
        }
        if (!config.searchClient && !config.createAlgoliaClient) {
            /** @type {?} */
            var client = algoliasearch(config.appId, config.apiKey);
            config.searchClient = client;
            config.appId = undefined;
            config.apiKey = undefined;
        }
        // custom algolia client agent
        if (typeof config.searchClient.addAlgoliaAgent === 'function') {
            // add user agents
            config.searchClient.addAlgoliaAgent("angular (" + AngularVersion.full + ")");
            config.searchClient.addAlgoliaAgent("angular-instantsearch (" + VERSION + ")");
        }
        this.instantSearchInstance = instantsearch(config);
        this.instantSearchInstance.on('render', this.onRender);
    };
    /**
     * @param {?} widget
     * @return {?}
     */
    NgAisInstantSearch.prototype.addWidget = /**
     * @param {?} widget
     * @return {?}
     */
    function (widget) {
        this.instantSearchInstance.addWidget(widget);
    };
    /**
     * @param {?} widget
     * @return {?}
     */
    NgAisInstantSearch.prototype.removeWidget = /**
     * @param {?} widget
     * @return {?}
     */
    function (widget) {
        this.instantSearchInstance.removeWidget(widget);
    };
    /**
     * @return {?}
     */
    NgAisInstantSearch.prototype.refresh = /**
     * @return {?}
     */
    function () {
        this.instantSearchInstance.refresh();
    };
    NgAisInstantSearch.decorators = [
        { type: Component, args: [{
                    selector: 'ais-instantsearch',
                    template: "<ng-content></ng-content>",
                },] },
    ];
    /** @nocollapse */
    NgAisInstantSearch.ctorParameters = function () { return [
        { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
    ]; };
    NgAisInstantSearch.propDecorators = {
        config: [{ type: Input }],
        instanceName: [{ type: Input }],
        change: [{ type: Output }]
    };
    return NgAisInstantSearch;
}());
export { NgAisInstantSearch };
if (false) {
    /** @type {?} */
    NgAisInstantSearch.prototype.config;
    /** @type {?} */
    NgAisInstantSearch.prototype.instanceName;
    /** @type {?} */
    NgAisInstantSearch.prototype.change;
    /** @type {?} */
    NgAisInstantSearch.prototype.instantSearchInstance;
    /** @type {?} */
    NgAisInstantSearch.prototype.onRender;
    /**
     * @type {?}
     * @private
     */
    NgAisInstantSearch.prototype.platformId;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5zdGFudHNlYXJjaC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItaW5zdGFudHNlYXJjaC8iLCJzb3VyY2VzIjpbImluc3RhbnRzZWFyY2gvaW5zdGFudHNlYXJjaC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUVMLFNBQVMsRUFDVCxLQUFLLEVBR0wsTUFBTSxFQUNOLFlBQVksRUFDWixNQUFNLEVBQ04sV0FBVyxFQUNYLE9BQU8sSUFBSSxjQUFjLEdBQzFCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRXBELE9BQU8sS0FBSyxrQkFBa0IsTUFBTSxvQkFBb0IsQ0FBQztBQUN6RCxPQUFPLGFBQWEsTUFBTSxxQkFBcUIsQ0FBQztBQUloRCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sWUFBWSxDQUFDOztJQUUvQixhQUFhLEdBQUcsa0JBQWtCLENBQUMsT0FBTyxJQUFJLGtCQUFrQjs7OztBQTBGdEUsNkNBRUM7OztJQURDLHdDQUFjOzs7OztBQUdoQiwyREFJQzs7O0lBRkMsMkRBQW1COztJQUNuQiwwREFBa0I7O0FBOEVwQjtJQUFBO0lBb0JBLENBQUM7SUFBRCw0QkFBQztBQUFELENBQUMsQUFwQkQsSUFvQkM7Ozs7SUFuQkMsc0NBQXlCOztJQUV6QiwwQ0FBMkM7O0lBQzNDLDJDQUErQzs7SUFFL0MsNkNBQThDOztJQUM5Qyw4Q0FBa0Q7O0lBR2xELG1DQUEyRDs7SUFDM0QsK0NBQXVFOztJQUV2RSx1Q0FHRTs7SUFFRix3Q0FBMkI7O0lBQzNCLHdDQUEyQjs7QUFHN0I7SUFnQkUsNEJBQXlDLFVBQWtCO1FBQTNELGlCQUErRDtRQUF0QixlQUFVLEdBQVYsVUFBVSxDQUFRO1FBVjNDLGlCQUFZLEdBQVcsU0FBUyxDQUFDO1FBR2pELFdBQU0sR0FBNkMsSUFBSSxZQUFZLEVBRy9ELENBQUM7UUE4REwsYUFBUSxHQUFHO1lBQ1QsS0FBSSxDQUFD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Z0JBeEVGLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsbUJBQW1CO29CQUM3QixRQUFRLEVBQUUsMkJBQTJCO2lCQUN0Qzs7OztnQkFhc0QsTUFBTSx1QkFBOUMsTUFBTSxTQUFDLFdBQVc7Ozt5QkFYOUIsS0FBSzsrQkFDTCxLQUFLO3lCQUVMLE1BQU07O0lBd0VULHlCQUFDO0NBQUEsQUFoRkQsSUFnRkM7U0E1RVksa0JBQWtCOzs7SUFDN0Isb0NBQTRDOztJQUM1QywwQ0FBaUQ7O0lBRWpELG9DQUlLOztJQUVMLG1EQUFvRDs7SUE0RHBELHNDQUtFOzs7OztJQS9EVSx3Q0FBK0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDb21wb25lbnQsXG4gIElucHV0LFxuICBPbkluaXQsXG4gIE9uRGVzdHJveSxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIEluamVjdCxcbiAgUExBVEZPUk1fSUQsXG4gIFZFUlNJT04gYXMgQW5ndWxhclZlcnNpb24sXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuXG5pbXBvcnQgKiBhcyBhbGdvbGlhc2VhcmNoUHJveHkgZnJvbSAnYWxnb2xpYXNlYXJjaC9saXRlJztcbmltcG9ydCBpbnN0YW50c2VhcmNoIGZyb20gJ2luc3RhbnRzZWFyY2guanMvZXMnO1xuaW1wb3J0IHsgQWxnb2xpYVNlYXJjaEhlbHBlciB9IGZyb20gJ2FsZ29saWFzZWFyY2gtaGVscGVyJztcblxuaW1wb3J0IHsgV2lkZ2V0IH0gZnJvbSAnLi4vYmFzZS13aWRnZXQnO1xuaW1wb3J0IHsgVkVSU0lPTiB9IGZyb20gJy4uL3ZlcnNpb24nO1xuXG5jb25zdCBhbGdvbGlhc2VhcmNoID0gYWxnb2xpYXNlYXJjaFByb3h5LmRlZmF1bHQgfHwgYWxnb2xpYXNlYXJjaFByb3h5O1xuXG5leHBvcnQgdHlwZSBTZWFyY2hSZXF1ZXN0ID0ge1xuICBpbmRleE5hbWU6IHN0cmluZztcbiAgcGFyYW1zOiBTZWFyY2hSZXF1ZXN0UGFyYW1ldGVycztcbn07XG5cbmV4cG9ydCB0eXBlIFNlYXJjaEZvckZhY2V0VmFsdWVzUmVxdWVzdCA9IHtcbiAgaW5kZXhOYW1lOiBzdHJpbmc7XG4gIHBhcmFtczogU2VhcmNoRm9yRmFjZXRWYWx1ZXNSZXF1ZXN0UGFyYW1ldGVycztcbn07XG5cbi8vIERvY3VtZW50YXRpb246IGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9hcGktcmVmZXJlbmNlL3NlYXJjaC1hcGktcGFyYW1ldGVycy9cbmV4cG9ydCB0eXBlIFNlYXJjaFBhcmFtZXRlcnMgPSB7XG4gIC8vIEF0dHJpYnV0ZXNcbiAgYXR0cmlidXRlc1RvUmV0cmlldmU/OiBzdHJpbmdbXTtcbiAgcmVzdHJpY3RTZWFyY2hhYmxlQXR0cmlidXRlcz86IHN0cmluZ1tdO1xuXG4gIC8vIEZpbHRlcmluZ1xuICBmaWx0ZXJzPzogc3RyaW5nO1xuICBmYWNldEZpbHRlcnM/OiBzdHJpbmdbXTtcbiAgb3B0aW9uYWxGaWx0ZXJzPzogc3RyaW5nW107XG4gIG51bWVyaWNGaWx0ZXJzPzogc3RyaW5nW107XG4gIHN1bU9yRmlsdGVyc1Njb3Jlcz86IGJvb2xlYW47XG5cbiAgLy8gRmFjZXRpbmdcbiAgZmFjZXRzPzogc3RyaW5nW107XG4gIG1heFZhbHVlc1BlckZhY2V0PzogbnVtYmVyO1xuICBmYWNldGluZ0FmdGVyRGlzdGluY3Q/OiBib29sZWFuO1xuICBzb3J0RmFjZXRWYWx1ZXNCeT86IHN0cmluZztcblxuICAvLyBIaWdobGlnaHRpbmcgLyBTbmlwcGV0aW5nXG4gIGF0dHJpYnV0ZXNUb0hpZ2hsaWdodD86IHN0cmluZ1tdO1xuICBhdHRyaWJ1dGVzVG9TbmlwcGV0Pzogc3RyaW5nW107XG4gIGhpZ2hsaWdodFByZVRhZz86IHN0cmluZztcbiAgaGlnaGxpZ2h0UG9zdFRhZz86IHN0cmluZztcbiAgc25pcHBldEVsbGlwc2lzVGV4dD86IHN0cmluZztcbiAgcmVzdHJpY3RIaWdobGlnaHRBbmRTbmlwcGV0QXJyYXlzPzogYm9vbGVhbjtcblxuICAvLyBQYWdpbmF0aW9uXG4gIHBhZ2U/OiBudW1iZXI7XG4gIGhpdHNQZXJQYWdlPzogbnVtYmVyO1xuICBvZmZzZXQ/OiBudW1iZXI7XG4gIGxlbmd0aD86IG51bWJlcjtcblxuICAvLyBUeXBvc1xuICBtaW5Xb3JkU2l6ZWZvcjFUeXBvPzogbnVtYmVyO1xuICBtaW5Xb3JkU2l6ZWZvcjJUeXBvcz86IG51bWJlcjtcbiAgdHlwb1RvbGVyYW5jZT86IHN0cmluZyB8IGJvb2xlYW47XG4gIGFsbG93VHlwb3NPbk51bWVyaWNUb2tlbnM/OiBib29sZWFuO1xuICBpZ25vcmVQbHVyYWxzPzogYm9vbGVhbiB8IHN0cmluZ1tdO1xuICBkaXNhYmxlVHlwb1RvbGVyYW5jZU9uQXR0cmlidXRlcz86IHN0cmluZ1tdO1xuXG4gIC8vIEdlby1TZWFyY2hcbiAgYXJvdW5kTGF0TG5nPzogc3RyaW5nO1xuICBhcm91bmRMYXRMbmdWaWFJUD86IGJvb2xlYW47XG4gIGFyb3VuZFJhZGl1cz86IG51bWJlciB8ICdhbGwnO1xuICBhcm91bmRQcmVjaXNpb24/OiBudW1iZXI7XG4gIG1pbmltdW1Bcm91bmRSYWRpdXM/OiBudW1iZXI7XG4gIGluc2lkZUJvdW5kaW5nQm94PzogR2VvUmVjdGFuZ2xlIHwgR2VvUmVjdGFuZ2xlW107XG4gIGluc2lkZVBvbHlnb24/OiBHZW9Qb2x5Z29uIHwgR2VvUG9seWdvbltdO1xuXG4gIC8vIFF1ZXJ5IFN0cmF0ZWd5XG4gIHF1ZXJ5VHlwZT86IHN0cmluZztcbiAgcmVtb3ZlV29yZHNJZk5vUmVzdWx0cz86IHN0cmluZztcbiAgYWR2YW5jZWRTeW50YXg/OiBib29sZWFuO1xuICBvcHRpb25hbFdvcmRzPzogc3RyaW5nIHwgc3RyaW5nW107XG4gIHJlbW92ZVN0b3BXb3Jkcz86IGJvb2xlYW4gfCBzdHJpbmdbXTtcbiAgZGlzYWJsZUV4YWN0T25BdHRyaWJ1dGVzPzogc3RyaW5nW107XG4gIGV4YWN0T25TaW5nbGVXb3JkUXVlcnk/OiBzdHJpbmc7XG4gIGFsdGVybmF0aXZlc0FzRXhhY3Q/OiBzdHJpbmdbXTtcblxuICAvLyBRdWVyeSBSdWxlc1xuICBlbmFibGVSdWxlcz86IGJvb2xlYW47XG4gIHJ1bGVDb250ZXh0cz86IHN0cmluZ1tdO1xuXG4gIC8vIEFkdmFuY2VkXG4gIG1pblByb3hpbWl0eT86IG51bWJlcjtcbiAgcmVzcG9uc2VGaWVsZHM/OiBzdHJpbmdbXTtcbiAgbWF4RmFjZXRIaXRzPzogbnVtYmVyO1xuICBwZXJjZW50aWxlQ29tcHV0YXRpb24/OiBib29sZWFuO1xuICBkaXN0aW5jdD86IG51bWJlciB8IGJvb2xlYW47XG4gIGdldFJhbmtpbmdJbmZvPzogYm9vbGVhbjtcbiAgY2xpY2tBbmFseXRpY3M/OiBib29sZWFuO1xuICBhbmFseXRpY3M/OiBib29sZWFuO1xuICBhbmFseXRpY3NUYWdzPzogc3RyaW5nW107XG4gIHN5bm9ueW1zPzogYm9vbGVhbjtcbiAgcmVwbGFjZVN5bm9ueW1zSW5IaWdobGlnaHQ/OiBib29sZWFuO1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hSZXF1ZXN0UGFyYW1ldGVycyBleHRlbmRzIFNlYXJjaFBhcmFtZXRlcnMge1xuICBxdWVyeTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlYXJjaEZvckZhY2V0VmFsdWVzUmVxdWVzdFBhcmFtZXRlcnNcbiAgZXh0ZW5kcyBTZWFyY2hQYXJhbWV0ZXJzIHtcbiAgZmFjZXRRdWVyeTogc3RyaW5nO1xuICBmYWNldE5hbWU6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgR2VvUmVjdGFuZ2xlID0gW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcl07XG5leHBvcnQgdHlwZSBHZW9Qb2x5Z29uID0gW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdO1xuXG4vLyBEb2N1bWVudGF0aW9uOiBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvcmVzdC1hcGkvc2VhcmNoLz9sYW5ndWFnZT1qYXZhc2NyaXB0I3NlYXJjaC1tdWx0aXBsZS1pbmRleGVzXG5leHBvcnQgdHlwZSBTZWFyY2hSZXNwb25zZSA9IHtcbiAgaGl0czogSGl0W107XG4gIHBhZ2U/OiBudW1iZXI7XG4gIG5iSGl0cz86IG51bWJlcjtcbiAgbmJQYWdlcz86IG51bWJlcjtcbiAgaGl0c1BlclBhZ2U/OiBudW1iZXI7XG4gIHByb2Nlc3NpbmdUaW1lTVM/OiBudW1iZXI7XG4gIHF1ZXJ5Pzogc3RyaW5nO1xuICBwYXJhbXM/OiBzdHJpbmc7XG4gIGluZGV4Pzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgSGl0ID0ge1xuICBfaGlnaGxpZ2h0UmVzdWx0Pzogb2JqZWN0O1xufTtcblxuLy8gRG9jdW1lbnRhdGlvbjogaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL3Jlc3QtYXBpL3NlYXJjaC8/bGFuZ3VhZ2U9amF2YXNjcmlwdCNzZWFyY2gtZm9yLWZhY2V0LXZhbHVlc1xuZXhwb3J0IHR5cGUgU2VhcmNoRm9yRmFjZXRWYWx1ZXNSZXNwb25zZSA9IHtcbiAgdmFsdWU6IHN0cmluZztcbiAgaGlnaGxpZ2h0ZWQ/OiBzdHJpbmc7XG4gIGNvdW50PzogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgU2VhcmNoQ2xpZW50ID0ge1xuICBhZGRBbGdvbGlhQWdlbnQ/OiAoYWdlbnQ6IHN0cmluZykgPT4gdm9pZDtcbiAgc2VhcmNoOiAocmVxdWVzdHM6IFNlYXJjaFJlcXVlc3RbXSkgPT4gUHJvbWlzZTx7IHJlc3VsdHM6IFNlYXJjaFJlc3BvbnNlW10gfT47XG4gIHNlYXJjaEZvckZhY2V0VmFsdWVzPzogKFxuICAgIHJlcXVlc3RzOiBTZWFyY2hGb3JGYWNldFZhbHVlc1JlcXVlc3RbXVxuICApID0+IFByb21pc2U8eyBmYWNldEhpdHM6IFNlYXJjaEZvckZhY2V0VmFsdWVzUmVzcG9uc2VbXSB9W10+O1xufTtcblxuZXhwb3J0IHR5cGUgSW5zdGFudFNlYXJjaENvbmZpZyA9IHtcbiAgYXBwSWQ/OiBzdHJpbmc7XG4gIGFwaUtleT86IHN0cmluZztcbiAgaW5kZXhOYW1lOiBzdHJpbmc7XG5cbiAgbnVtYmVyTG9jYWxlPzogc3RyaW5nO1xuICBzZWFyY2hGdW5jdGlvbj86IChoZWxwZXI6IEFsZ29saWFTZWFyY2hIZWxwZXIpID0+IHZvaWQ7XG4gIGNyZWF0ZUFsZ29saWFDbGllbnQ/OiAoXG4gICAgYWxnb2xpYXNlYXJjaDogRnVuY3Rpb24sXG4gICAgYXBwSWQ6IHN0cmluZyxcbiAgICBhcGlLZXk6IHN0cmluZ1xuICApID0+IG9iamVjdDtcbiAgc2VhcmNoQ2xpZW50PzogU2VhcmNoQ2xpZW50O1xuICBzZWFyY2hQYXJhbWV0ZXJzPzogU2VhcmNoUGFyYW1ldGVycyB8IHZvaWQ7XG4gIHVybFN5bmM/OlxuICAgIHwgYm9vbGVhblxuICAgIHwge1xuICAgICAgICBtYXBwaW5nPzogb2JqZWN0O1xuICAgICAgICB0aHJlc2hvbGQ/OiBudW1iZXI7XG4gICAgICAgIHRyYWNrZWRQYXJhbWV0ZXJzPzogc3RyaW5nW107XG4gICAgICAgIHVzZUhhc2g/OiBib29sZWFuO1xuICAgICAgICBnZXRIaXN0b3J5U3RhdGU/OiAoKSA9PiBvYmplY3Q7XG4gICAgICB9O1xuICByb3V0aW5nPzpcbiAgICB8IGJvb2xlYW5cbiAgICB8IHtcbiAgICAgICAgcm91dGVyPzoge1xuICAgICAgICAgIG9uVXBkYXRlOiAoY2I6IChvYmplY3QpID0+IHZvaWQpID0+IHZvaWQ7XG4gICAgICAgICAgcmVhZDogKCkgPT4gb2JqZWN0O1xuICAgICAgICAgIHdyaXRlOiAocm91dGVTdGF0ZTogb2JqZWN0KSA9PiB2b2lkO1xuICAgICAgICAgIGNyZWF0ZVVSTDogKHJvdXRlU3RhdGU6IG9iamVjdCkgPT4gc3RyaW5nO1xuICAgICAgICAgIGRpc3Bvc2U6ICgpID0+IHZvaWQ7XG4gICAgICAgIH07XG4gICAgICAgIHN0YXRlTWFwcGluZz86IHtcbiAgICAgICAgICBzdGF0ZVRvUm91dGUob2JqZWN0KTogb2JqZWN0O1xuICAgICAgICAgIHJvdXRlVG9TdGF0ZShvYmplY3QpOiBvYmplY3Q7XG4gICAgICAgIH07XG4gICAgICB9O1xufTtcblxuZXhwb3J0IGNsYXNzIEluc3RhbnRTZWFyY2hJbnN0YW5jZSB7XG4gIHB1YmxpYyBzdGFydDogKCkgPT4gdm9pZDtcblxuICBwdWJsaWMgYWRkV2lkZ2V0OiAod2lkZ2V0OiBXaWRnZXQpID0+IHZvaWQ7XG4gIHB1YmxpYyBhZGRXaWRnZXRzOiAod2lkZ2V0czogV2lkZ2V0W10pID0+IHZvaWQ7XG5cbiAgcHVibGljIHJlbW92ZVdpZGdldDogKHdpZGdldDogV2lkZ2V0KSA9PiB2b2lkO1xuICBwdWJsaWMgcmVtb3ZlV2lkZ2V0czogKHdpZGdldHM6IFdpZGdldFtdKSA9PiB2b2lkO1xuXG4gIC8vIEV2ZW50RW1taXRlclxuICBwdWJsaWMgb246IChldmVudE5hbWU6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uKSA9PiB2b2lkO1xuICBwdWJsaWMgcmVtb3ZlTGlzdGVuZXI6IChldmVudE5hbWU6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uKSA9PiB2b2lkO1xuXG4gIHB1YmxpYyBoZWxwZXI6IHtcbiAgICBsYXN0UmVzdWx0czogT2JqZWN0O1xuICAgIHN0YXRlOiBPYmplY3Q7XG4gIH07XG5cbiAgcHVibGljIHJlZnJlc2g6ICgpID0+IHZvaWQ7XG4gIHB1YmxpYyBkaXNwb3NlOiAoKSA9PiB2b2lkO1xufVxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhaXMtaW5zdGFudHNlYXJjaCcsXG4gIHRlbXBsYXRlOiBgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PmAsXG59KVxuZXhwb3J0IGNsYXNzIE5nQWlzSW5zdGFudFNlYXJjaCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQsIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgQElucHV0KCkgcHVibGljIGNvbmZpZzogSW5zdGFudFNlYXJjaENvbmZpZztcbiAgQElucHV0KCkgcHVibGljIGluc3RhbmNlTmFtZTogc3RyaW5nID0gJ2RlZmF1bHQnO1xuXG4gIEBPdXRwdXQoKVxuICBjaGFuZ2U6IEV2ZW50RW1pdHRlcjx7IHJlc3VsdHM6IHt9OyBzdGF0ZToge30gfT4gPSBuZXcgRXZlbnRFbWl0dGVyPHtcbiAgICByZXN1bHRzOiB7fTtcbiAgICBzdGF0ZToge307XG4gIH0+KCk7XG5cbiAgcHVibGljIGluc3RhbnRTZWFyY2hJbnN0YW5jZTogSW5zdGFudFNlYXJjaEluc3RhbmNlO1xuXG4gIGNvbnN0cnVjdG9yKEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0KSB7fVxuXG4gIHB1YmxpYyBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmNyZWF0ZUluc3RhbnRTZWFyY2hJbnN0YW5jZSh0aGlzLmNvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlLnN0YXJ0KCk7XG4gIH1cblxuICBwdWJsaWMgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5pbnN0YW50U2VhcmNoSW5zdGFuY2UucmVtb3ZlTGlzdGVuZXIoJ3JlbmRlcicsIHRoaXMub25SZW5kZXIpO1xuICAgIHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlLmRpc3Bvc2UoKTtcbiAgfVxuXG4gIHB1YmxpYyBjcmVhdGVJbnN0YW50U2VhcmNoSW5zdGFuY2UoY29uZmlnOiBJbnN0YW50U2VhcmNoQ29uZmlnKSB7XG4gICAgLy8gYWRkIGRlZmF1bHQgc2VhcmNoUGFyYW1ldGVycyB3aXRoIGhpZ2hsaWdodGluZyBjb25maWdcbiAgICBpZiAoIWNvbmZpZy5zZWFyY2hQYXJhbWV0ZXJzKSBjb25maWcuc2VhcmNoUGFyYW1ldGVycyA9IHt9O1xuICAgIE9iamVjdC5hc3NpZ24oY29uZmlnLnNlYXJjaFBhcmFtZXRlcnMsIHtcbiAgICAgIGhpZ2hsaWdodFByZVRhZzogJ19fYWlzLWhpZ2hsaWdodF9fJyxcbiAgICAgIGhpZ2hsaWdodFBvc3RUYWc6ICdfXy9haXMtaGlnaGxpZ2h0X18nLFxuICAgIH0pO1xuXG4gICAgLy8gcmVtb3ZlIFVSTFN5bmMgd2lkZ2V0IGlmIG9uIFNTUlxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgaWYgKHR5cGVvZiBjb25maWcudXJsU3luYyAhPT0gJ3VuZGVmaW5lZCcpIGRlbGV0ZSBjb25maWcudXJsU3luYztcbiAgICAgIGlmICh0eXBlb2YgY29uZmlnLnJvdXRpbmcgIT09ICd1bmRlZmluZWQnKSBkZWxldGUgY29uZmlnLnJvdXRpbmc7XG4gICAgfVxuXG4gICAgaWYgKCFjb25maWcuc2VhcmNoQ2xpZW50ICYmICFjb25maWcuY3JlYXRlQWxnb2xpYUNsaWVudCkge1xuICAgICAgY29uc3QgY2xpZW50ID0gYWxnb2xpYXNlYXJjaChjb25maWcuYXBwSWQsIGNvbmZpZy5hcGlLZXkpO1xuICAgICAgY29uZmlnLnNlYXJjaENsaWVudCA9IGNsaWVudDtcbiAgICAgIGNvbmZpZy5hcHBJZCA9IHVuZGVmaW5lZDtcbiAgICAgIGNvbmZpZy5hcGlLZXkgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLy8gY3VzdG9tIGFsZ29saWEgY2xpZW50IGFnZW50XG4gICAgaWYgKHR5cGVvZiBjb25maWcuc2VhcmNoQ2xpZW50LmFkZEFsZ29saWFBZ2VudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gYWRkIHVzZXIgYWdlbnRzXG4gICAgICBjb25maWcuc2VhcmNoQ2xpZW50LmFkZEFsZ29saWFBZ2VudChgYW5ndWxhciAoJHtBbmd1bGFyVmVyc2lvbi5mdWxsfSlgKTtcbiAgICAgIGNvbmZpZy5zZWFyY2hDbGllbnQuYWRkQWxnb2xpYUFnZW50KGBhbmd1bGFyLWluc3RhbnRzZWFyY2ggKCR7VkVSU0lPTn0pYCk7XG4gICAgfVxuICAgIHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlID0gaW5zdGFudHNlYXJjaChjb25maWcpO1xuICAgIHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlLm9uKCdyZW5kZXInLCB0aGlzLm9uUmVuZGVyKTtcbiAgfVxuXG4gIHB1YmxpYyBhZGRXaWRnZXQod2lkZ2V0OiBXaWRnZXQpIHtcbiAgICB0aGlzLmluc3RhbnRTZWFyY2hJbnN0YW5jZS5hZGRXaWRnZXQod2lkZ2V0KTtcbiAgfVxuXG4gIHB1YmxpYyByZW1vdmVXaWRnZXQod2lkZ2V0OiBXaWRnZXQpIHtcbiAgICB0aGlzLmluc3RhbnRTZWFyY2hJbnN0YW5jZS5yZW1vdmVXaWRnZXQod2lkZ2V0KTtcbiAgfVxuXG4gIHB1YmxpYyByZWZyZXNoKCkge1xuICAgIHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlLnJlZnJlc2goKTtcbiAgfVxuXG4gIG9uUmVuZGVyID0gKCkgPT4ge1xuICAgIHRoaXMuY2hhbmdlLmVtaXQoe1xuICAgICAgcmVzdWx0czogdGhpcy5pbnN0YW50U2VhcmNoSW5zdGFuY2UuaGVscGVyLmxhc3RSZXN1bHRzLFxuICAgICAgc3RhdGU6IHRoaXMuaW5zdGFudFNlYXJjaEluc3RhbmNlLmhlbHBlci5zdGF0ZSxcbiAgICB9KTtcbiAgfTtcbn1cbiJdfQ==